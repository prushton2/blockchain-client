<!DOCTYPE html>
<html>
    <head>

    </head>
    <body>
        <h1>Blockchain</h1>


        <table>
            <tr>
                <td>

                    Active User Name: <br>
                    <input id="activeUserInput"> <button onClick="setActiveUser()">Set</button><br>
                    
                    <label id="activeUserOutput"></label><br><br>
                </td>
                <td>
                    Create User:<br>
                    <input id="newUserInput"> <button onclick="makeRequest('newUserInput', 'newUserOutput', 'Creating User...', 'NewUser')">Create User</button><br>
            
                    <label id="newUserOutput"></label><br><br>
                </td>    
            </tr>
            <tr>
                <td>
                    Create a new Block:<br>
                    <input id="newBlockInput" placeholder="Block Info"> <button onclick="makeRequest('newBlockInput', 'newBlockOutput', 'Creating Block...', 'NewBlock')">Create Block</button><br>
                    <label id="newBlockOutput"></label><br><br>
                </td>
                <td id="deleteArea">
                    
                </td>
        </tr>
        </table>

        List:<br>
        <input id="lsInput" placeholder="Search"></input> <button onclick="makeRequest('lsInput', 'lsOutput', 'Searching...', 'ls')">Search</button><br>

        <label id="lsOutput"></label>




        <script>

            const makeRequest = async(input, output, placeholder, url) => {
                value = document.getElementById(input).value
                document.getElementById(output).innerHTML = placeholder
                document.getElementById(output).innerHTML = await sendCommand(`${url}/${value}`)
            }

            const setActiveUser = async() => {
                name = document.getElementById("activeUserInput").value
                response = await sendCommand(`setActiveUser/${name}`)
                document.getElementById("activeUserOutput").innerHTML = response
                if(response == "Opened key pair: admin") {
                    document.getElementById("deleteArea").innerHTML = `Delete Object:<br><input id='deleteInput'> <button onclick="makeRequest('deleteInput', 'deleteOutput', 'Deleting...', 'del')">Delete</button><br><label id='deleteOutput'></label><br><br>`
                } else {
                    document.getElementById("deleteArea").innerHTML = ""
                }
            }

            const sendCommand = async(text) => {
                return await fetch(`http://localhost:5000/${text}`).then((response) => {return response.text()})
            }
        </script>
        <style type="text/css" media="screen">
            body {
                color: #D4D4D4;
                background-color: #1e1e1e;
            }
            h1 {
                size: 200%;
            }
            input {
                color: #D4D4D4;
                background-color: #2f2f2f;
            }
            button {
                color: #D4D4D4;
                background-color: #2f2f2f;
            }
            label {
                color: #D4D4D4;
            }
                
        </style>
    </body>
</html>